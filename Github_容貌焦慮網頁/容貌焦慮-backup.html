<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>打破容貌焦慮的枷鎖</title>
    <script src="Build/UnityLoader.js"></script>
    <script>
        var unityInstance = UnityLoader.instantiate("unity-canvas", "Build/YourBuildName.json");
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>

    <script>
        function showTitleAndHint() {
            const heroContent = document.querySelector('.hero-content');
            const hint = document.querySelector('.scroll-hint');
            const h1 = heroContent.querySelector('h1');
            const p = heroContent.querySelector('p');

            // 顯示 hero-content
            heroContent.style.display = 'block';
            heroContent.classList.add('fade-in');

            // 將 h1 和 p 的透明度設置為 1，並添加淡入效果
            setTimeout(() => {
                h1.style.opacity = '1';  
                p.style.opacity = '1';
            }, 1000);  // 1000 毫秒後觸發淡入

            // 延遲顯示提示文字，並添加閃爍效果的 class
            setTimeout(() => {
                hint.style.display = 'block';
                hint.classList.add('fade-in-out');
            }, 1000); // 1秒後顯示提示文字
           
        }
        function allowManualScroll() {
            // 確保滾動可用，允許用戶手動滾動
            document.body.style.overflow = 'auto';  // 設置 body 可以滾動
            
            // 淡入顯示內容區域
            setTimeout(() => {
                const content = document.querySelector('.content');
                if (content) {
                    content.style.opacity = '1';  // 設置內容透明度為可見
                }
            }, 500);
        }

        // 禁用頁面垂直滾動，直到遊戲結束
        document.body.style.overflowY = 'hidden';

        // 當遊戲結束時恢復滾動
        function enableScroll() {
            document.body.style.overflowY = 'auto';  // 允許整個頁面滾動
        }

        // 監聽遊戲結束的訊息
        window.addEventListener('message', (event) => {
            if (event.data === 'gameOver') {
                enableScroll();  // 遊戲結束時允許滾動
            }
        });

        // 當在 iframe 上滾動時，將事件傳遞給父頁面
        iframe.contentWindow.addEventListener('wheel', (event) => {
            event.preventDefault(); // 禁止 iframe 自己的滾動
            window.scrollBy(0, event.deltaY); // 傳遞滾動事件到頁面
        });

    </script>
    
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(#8C8069, #F3E6CC);
            color: #FFFFFF;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            transition: background 0.5s ease-in-out;
            scroll-behavior: smooth; /* 平滑滾動效果 */
            overflow-y: scroll; /* 確保 body 可以垂直滾動 */
            scroll-snap-type: y mandatory; /* 垂直滾動並必須吸附 */
        }
        header {
            background-color: #000000;
            padding: 40px 20px;
            text-align: center;
        }
        
        .scroll-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2em;
            color: #FFFFFF;
            opacity: 0;
            animation: fadeInOut 2s ease-in-out infinite; /* 閃爍效果 */
            display: none;
            cursor: pointer;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        /* 閃爍效果 */
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        /* 淡效果 */
        .fade-in {
            opacity: 1;  /* 淡入顯示 */
        }

        /* 設定章節之間的距離 */
        .section {
            margin-bottom: 60px;
        }

        /* 小標 */
        .section-title {
            font-size: 2em;
            margin-bottom: 20px;
        }

        /* 內容樣式 */
        .section-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
        }

        a {
            color: #FFD700;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        footer {
            background-color: #111111;
            color: #999999;
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
        }
        
        .hero {
            position: relative;
            width: 100%;
            height: 100vh; /* 全屏 */
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* 顶部和底部分开 */
            text-align: center;
            background-color: #000; /* 背景色可以根据需求调整 */
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out; /* 平滑过渡效果 */
        }

        .hero.hidden {
            transform: translateY(-100%); /* 向上平移离开视窗 */
            opacity: 0; /* 隐藏 */
        }

        .hero-content {
            position: relative;
            top: 50%; 
            transform: translateY(-50%); /* 垂直居中标题 */
            z-index: 10; /* 确保标题在最上层 */
            pointer-events: none; /* 禁用标题的点击事件，使下层元素可以拖动 */
        }
                
        .hero h1, .hero p {
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            opacity: 0; /* 初始透明度為0 */
            transition: opacity 2s ease-in-out; /* 添加淡入過渡效果 */
            margin: 0; 
            padding: 0; 
            text-align: center; /* 置中 */
        }

        .hero h1 {
            font-size: 4em;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.5em;
            margin-bottom: 30px;
        }
        .interactive-game {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh; /* 確保高度佔滿視窗 */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            object-fit: cover;
        }

        .dot-nav {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 9999;
            padding: 10px;
            border-radius: 20px;
        }
        .dot-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .dot-nav li {
            margin: 10px 0;
        }
        .dot {
            display: block;
            width: 15px; /* 調整圓點尺寸 */
            height: 15px; /* 調整圓點尺寸 */
            border-radius: 50%;
            background-color: #fff; /* 白色圓點 */
            margin: 10px 0;
            transition: all 0.3s ease;
        }
        .dot.active {
            background-color: #333; /* 選取時變深灰色 */
            transform: scale(1.2);
        }
        
        .mirror-pieces {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .mirror-piece {
            width: 100px;
            height: 100px;
            background-size: contain;
            background-repeat: no-repeat;
            cursor: move;
        }
        .mirror-target {
            width: 300px;
            height: 300px;
            background-image: url('images/mirror_piece.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            margin: 0 auto;
            position: relative;
        }
        .dropped-piece {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: contain;
            background-repeat: no-repeat;
            top: 0;
            left: 0;
        }
        
        #chart-container {
            width: 80%;
            margin: 50px auto;
        }
    
        #quiz-container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 50px auto;
            color: #3E3E40; /* 設置文字顏色 */
        }
        .question {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin: 5px 0;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        #trigger-section {
            height: 300vh; /* 使 section 足够高来触发滚动 */
            position: relative;
        }

        .image-switch {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30%;
            display: none;
            opacity: 1;
            transition: opacity 1s ease-out;
        }

        .hidden {
            opacity: 0;
        }

        .fade-in {
            opacity: 0;
            animation: fadeInText 2s forwards;
        }

        @keyframes fadeInText {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .empty-section {
            height: 100vh; /* 確保足夠高度，讓滾動觸發效果 */
        }

        
        /* 半透明提示框 */
        .game-hint {
            position: absolute;
            top: 83%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10%; /* 占据 80% 的屏幕宽度 */
            padding: 17px;
            background-color: rgba(0, 0, 0, 0.7); /* 半透明黑色背景 */
            color: #ffffff;
            text-align: center;
            font-size: 1em;
            border-radius: 15px; /* 圆角 */
            z-index: 9999; /* 保证在游戏层之上 */
            opacity: 0; /* 初始透明度为0，用于淡入效果 */
            pointer-events: none; /* 禁用点击件，不干扰游戏 */
            transition: opacity 0.5s ease-in-out; /* 淡入淡出效果 */
        }

        /* 提示框内文字 */
        .game-hint p {
            margin: 0;
            font-size: 1em;
            line-height: 1.5;
            font-weight: bold;
        }

    
        
        .content {
            max-width: 800px;
            margin: 20pt auto;
            padding: 40px 20px;
            opacity: 0;
            position: relative;
            color: #3E3E40;
            min-height: 100vh; /* 確保章節內容有足夠高度 */
            transition: opacity 1.5s ease, transform 1.5s ease;
            position: relative;
            overflow: auto; /* 允許內容內部滾動 */
            padding: 20px; /* 內部填充 */
            background-color: rgba(255, 255, 255, 0.9); /* 白色背景 */
            border-radius: 10px; /* 圓角 */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* 陰影效果 */
            margin-top: 20px; /* 上方距離 */
            margin-bottom: 20px; /* 下方距離 */
        }

        .chapter-title {
            font-family: 'NewTegomin', serif; /* 使用新字體 */
            position: relative;
            top: 40px;
            font-size: 1.8em;
            z-index: 10;
            padding: 20px;
            color: white;
            transition: position 0.5s ease-in-out; /* 平滑过渡效果 */
            margin-right: 10px; /* 调整标题与内容之间的间距 */
            text-align: right;
        }

        .content-section {
            max-width: 800px;
            margin: 20pt auto;
            padding: 40px 20px;
            position: relative;
            color: #3E3E40;
            min-height: 100vh; /* 确保章节内容有足够高度 */
            overflow: hidden; /* 隐藏滚动条 */
            height: 80vh; /* 固定内容区域的高度 */
            background-color: rgba(255, 255, 255, 0.9); /* 白底 */
            border-radius: 10pt;
        }



        .chapter-section {
            display: block; /* 確保顯示 */
            opacity: 1; /* 確保可見 */
            min-height: 100vh; /* 最小高度設置為視窗高度，但允許內容超出時自動增高 */
            padding: 40px; /* 添加內邊距，讓內容與邊框保持距離 */
            box-sizing: border-box; /* 確保 padding 被包含在元素的高度中 */
            position: relative; /* 確保隨著滾動而移動 */
        }

        .chapter-title.sticky {
            position: sticky;
            top: 20px;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            right: 10px; /* 保持右對齊 */
        }

        .content.sticky {
            opacity: 1;
            transform: translateY(0);
            transition: opacity 1s ease-in-out, transform 1s ease-in-out;
        }

        .chapter-title.hide {
            opacity: 0;
            transform: translateY(-50px);
        }


        .container {
            scroll-snap-type: y mandatory; /* 启用滚动切换 */
            overflow-y: auto; /* 允许垂直滚动 */
            height: calc(100vh - 100px); /* 替换<hero-section的高度>为具体值 */
        }

        .hero-section {
            scroll-snap-align: start; /* 添加滚动对齐 */
            /* ... 现有样式 ... */
        }

        .chapter1 {
            scroll-snap-align: start; /* 添加滚动对齐 */
            /* ... 现有样式 ... */
        }
    </style>
    
</head>
<body>
    <nav class="dot-nav">
        <ul>
            <li><a href="#game-section" class="dot" data-section="game-section"></a></li>
            <li><a href="#section1" class="dot" data-section="section1"></a></li>
            <li><a href="#section2" class="dot" data-section="section2"></a></li>
            <li><a href="#section3" class="dot" data-section="section3"></a></li>
        </ul>
    </nav>
    
    <div class="game-hint" id="game-hint">
        <p>拖曳碎片來拼合鏡子！</p>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const gameHint = document.getElementById('game-hint');
            const gameIframe = document.querySelector('iframe');
            let hasShownHint = false;
            const iframe = document.querySelector('iframe');

            // 當遊戲結束時恢復滾動
            function enableScroll() {
                document.body.style.overflowY = 'auto';
            }

            // 監聽遊戲結束的訊息
            window.addEventListener('message', (event) => {
                if (event.data === 'gameOver') {
                    enableScroll();
                }
            });

            // 當在 iframe 上滾動時，將事件傳遞給父頁面
            iframe.contentWindow.addEventListener('wheel', (event) => {
                event.preventDefault(); // 禁止 iframe 自己的滾動
                window.scrollBy(0, event.deltaY); // 傳遞滾動事件到頁面
            });
    

            // 当游戏加载完成时执行
            gameIframe.onload = function() {
                if (!hasShownHint) {
                    // 游戏加载完成，显示提示框
                    setTimeout(function() {
                        gameHint.style.opacity = '1'; // 显示提示框

                        // 3秒后隐藏提示框
                        setTimeout(function() {
                            gameHint.style.opacity = '0'; // 隐藏提示框
                        }, 3000); // 3秒后自动隐藏
                    }, 1000); // 延迟 1 秒后显示提示框，确保游戏画面完全加载
                    hasShownHint = true; // 标记提示框已显示
                }
            };
        });
    </script>
    
    <div class="hero">
        <div class="hero-content">
            <h1>打破容貌焦慮的枷鎖</h1>
            <p>從釐清迷思到跳脫慮的指南</p>
        </div>
        <div class="interactive-game" style="overflow: auto;"> 
            <iframe src="godot-game/mirror-game.html"></iframe> <!-- 插入 Godot 遊戲 -->
        </div>
        <div class="scroll-hint">向下滾動以繼續閱讀</div>
    </div>

    
    

    <div class="chapter-section" id="chapter1">
        <div class="chapter-title">
            【解構迷思】<br>
            為何許多人有容貌焦慮？
        </div><!-- Sticky 標題 -->
            <div class="content">
                <h2>小標</h2>
                <p>在自我展示成為常態的時代，我們或許都曾在某一刻，定格在那片冷冽的反光中，端詳自己的面孔，試圖尋找些什麼，也許是美，也許是缺陷。然而，我們真正尋找的，是滿足社會期待的完美形象，還是某種讓自己安心的確認：「我看起來還不錯吧？」</p>
                <p>但在那追尋的過程中，有些人開始迷失在鏡像、影像與現實之間，容貌焦慮便從這樣的縫隙中悄然滋生。它不是簡單的對外貌的關注，而是像黑霧般的焦慮，逐漸吞噬對自我的認同感。</p>
                
                <p><strong style="color: green;">容貌焦慮，是當我們無法從鏡子裡看見真實的自己，而只能看到他人與自我期待的樣貌時，心底所泛起的恐懼。</strong></p>
                
                <div id="chart-container">
                    <canvas id="myChart"></canvas>
                </div>
                <p>猶如一面破碎的鏡子，將裂痕映射在臉上，讓每一個不完美的角落變得無比尖銳，時不時扎進心房。</p>


                <!-- 心理測驗內容 -->
                <div id="quiz-container">
                    <h2>怎麼知道自己是否患有容貌焦慮症？</h2>
                    <form id="quiz-form">
                        <!-- 題目 1 -->
                        <div class="question" id="question-1">
                            <p>1. 你一天會刻意檢查自己的外貌幾次？（不小心瞥到鏡子看一下那種不算）</p>
                            <label><input type="radio" name="q1" value="4"> 40次</label>
                            <label><input type="radio" name="q1" value="3"> 20次</label>
                            <label><input type="radio" name="q1" value="2"> 10次</label>
                            <label><input type="radio" name="q1" value="1"> 5</label>
                            <label><input type="radio" name="q1" value="0"> 從不</label>
                            <button type="button" onclick="nextQuestion(1)">下一題</button>
                        </div>
                        <!-- 題目 2 -->
                        <div class="question" id="question-2" style="display:none;">
                            <p>2. 你認為自己的外表怎麼樣？</p>
                            <label><input type="radio" name="q2" value="4"> 非常不好看</label>
                            <label><input type="radio" name="q2" value="3"> 好</label>
                            <label><input type="radio" name="q2" value="2"> 還好</label>
                            <label><input type="radio" name="q2" value="1"> 有點不好看</label>
                            <label><input type="radio" name="q2" value="0"> 完全不覺得難看</label>
                            <button type="button" onclick="nextQuestion(2)">下一題</button>
                        </div>
                        <!-- 題目 3 -->
                        <div class="question" id="question-3" style="display:none;">
                            <p>3. 你的外貌會讓你心情低落嗎？</p>
                            <label><input type="radio" name="q3" value="4"> 極度低落</label>
                            <label><input type="radio" name="q3" value="3"> 非常低落</label>
                            <label><input type="radio" name="q3" value="2"> 中等</label>
                            <label><input type="radio" name="q3" value="1"> 有點低落</label>
                            <label><input type="radio" name="q3" value="0"> 完全低落</label>
                            <button type="button" onclick="nextQuestion(3)">下一題</button>
                        </div>
                        <!-- 題目 4 -->
                        <div class="question" id="question-4" style="display:none;">
                            <p>4. 你有多常因為自己的外貌避免社交活動？</p>
                            <label><input type="radio" name="q4" value="4"> 每次</label>
                            <label><input type="radio" name="q4" value="3"> 10次中有7次</label>
                            <label><input type="radio" name="q4" value="2"> 10次中有5次</label>
                            <label><input type="radio" name="q4" value="1"> 10次中有3次</label>
                            <label><input type="radio" name="q4" value="0"> 從不</label>
                            <button type="button" onclick="nextQuestion(4)">下一題</button>
                        </div>
                        <!-- 題目 5 -->
                        <div class="question" id="question-5" style="display:none;">
                            <p>5. 容貌問題多常佔據你的思考時間？</p>
                            <label><input type="radio" name="q5" value="4"> 極度頻繁</label>
                            <label><input type="radio" name="q5" value="3"> 時常</label>
                            <label><input type="radio" name="q5" value="2"> 半數時間</label>
                            <label><input type="radio" name="q5" value="1"> 時</label>
                            <label><input type="radio" name="q5" value="0"> 完全不會</label>
                            <button type="button" onclick="nextQuestion(5)">下一題</button>
                        </div>
                        <!-- 題目 6 -->
                        <div class="question" id="question-6" style="display:none;">
                            <p>6. 外貌對你的伴侶、戀愛生活造成多大的影響？</p>
                            <label><input type="radio" name="q6" value="4"> 極大影響</label>
                            <label><input type="radio" name="q6" value="3"> 很大影響</label>
                            <label><input type="radio" name="q6" value="2"> 中等影響</label>
                            <label><input type="radio" name="q6" value="1"> 有點影響</label>
                            <label><input type="radio" name="q6" value="0"> 沒影響</label>
                            <button type="button" onclick="nextQuestion(6)">下一題</button>
                        </div>
                        <!-- 題目 7 -->
                        <div class="question" id="question-7" style="display:none;">
                            <p>7. 外貌對你的工作、學習能力造成多大影響？</p>
                            <label><input type="radio" name="q7" value="4"> 極大影響導致無法處理</label>
                            <label><input type="radio" name="q7" value="3"> 很大影響</label>
                            <label><input type="radio" name="q7" value="2"> 中等影響</label>
                            <label><input type="radio" name="q7" value="1"> 有點影響</label>
                            <label><input type="radio" name="q7" value="0"> 沒影響</label>
                            <button type="button" onclick="nextQuestion(7)">下一題</button>
                        </div>
                        <!-- 題目 8 -->
                        <div class="question" id="question-8" style="display:none;">
                            <p>8. 外貌對你的社交生活造成多大的干擾？</p>
                            <label><input type="radio" name="q8" value="4"> 極大</label>
                            <label><input type="radio" name="q8" value="3"> 非常</label>
                            <label><input type="radio" name="q8" value="2"> 中等</label>
                            <label><input type="radio" name="q8" value="1"> 有</label>
                            <label><input type="radio" name="q8" value="0"> 完全不會</label>
                            <button type="button" onclick="nextQuestion(8)">下一題</button>
                        </div>
                        <!-- 目 9 -->
                        <div class="question" id="question-9" style="display:none;">
                            <p>9. 外貌對於定義「你是誰」很重要，你認同這句話嗎？</p>
                            <label><input type="radio" name="q9" value="4"> 超級認同</label>
                            <label><input type="radio" name="q9" value="3"> 非常認同</label>
                            <label><input type="radio" name="q9" value="2"> 中認同</label>
                            <label><input type="radio" name="q9" value="1"> 有點認同</label>
                            <label><input type="radio" name="q9" value="0"> 完全不認同</label>
                            <button type="button" onclick="calculateScore()">提交</button>
                        </div>
                    </form>
                    <div id="result"></div>
                </div>
            </div>
        </div>


    

    <!-- 第二章 -->
    <div class="chapter-section" id="chapter2">
        <div class="chapter-title">【第二章】</div> <!-- Sticky 標題 -->
        <div class="content">
            <h2>小標</h2>
            <p>在自我展示成為常態的時代，我們或許都曾在某一刻，定格在那片冷冽的反光中，端詳自己的面孔，試圖尋找些什麼，也許是美，也許是缺陷。然而，我們真正尋找的，是滿足社會期待的完美形象，還是某種讓自己安心的確認：「我看起來還不錯吧？」</p>
            <p>但在那追尋的過程中，有些人開始迷失在鏡像、影像與現實之間，容貌焦慮便從這樣的縫隙中悄然滋生。它不是簡單的對外貌的關注，而是像黑霧般的焦慮，逐漸吞噬對自我的認同感。</p>
            
            <p><strong style="color: green;">容貌焦慮，是當我們無法從鏡子裡看見真實的自己，而只能看到他人與自我期待的樣貌時，心底所泛起的恐懼。</strong></p>
            
            <p>猶如一面破碎的鏡子，將裂痕映射在臉上，讓每一個不完美的角落變得無比尖銳，時不時扎進心房。</p>
        </div>
    </div>

    <section id="trigger-section" style="text-align: center;">
        <img src="images/test1.png" class="image-switch" id="image1" style="width: 30%; display: none; margin: 0 auto;">
        <img src="images/test2.png" class="image-switch" id="image2" style="width: 30%; display: none; margin: 0 auto;">
        <img src="images/test3.png" class="image-switch" id="image3" style="width: 30%; display: none; margin: 0 auto;">
        <img src="images/test4.png" class="image-switch" id="image4" style="width: 30%; display: none; margin: 0 auto;">
        <div class="empty-section"></div>
    </section>
    
    <!-- 新增的空白區域，確保足夠高度來觸發滾動效果 -->
    <section class="empty-section" style="height: 250vh;"></section>


    <!-- 第三章 -->
    <div class="chapter-section" id="chapter3">
        <div class="chapter-title">【第三章】</div> <!-- Sticky 標題 -->
        <div class="content">
            <h2>小標</h2>
            <p>在自我展示成為常態的時代，我們或許都曾在某一刻，定格在那片冷冽的反光中，端詳自己的面孔，試圖尋找些什麼，也許是美，也許是缺陷。然而，我們真正尋找的，是滿足社會期待的完美形象，還是某種讓自己安心的確認：「我看起來還不錯吧？」</p>
            <p>但在那追尋的過程中，有些人開始迷失在鏡像、影像與現實之間，容貌焦慮便從這樣的縫隙中悄然滋生。它不是簡單的對外貌的關注，而是像黑霧般的焦慮，逐漸吞噬對自我的認同感。</p>
            
            <p><strong style="color: green;">容貌焦慮，是當我們無法從鏡子裡看見真實的自己，而只能看到他人與自我期待的樣貌時，心底所泛起的恐懼。</strong></p>
            
            <p>猶如一面破碎的鏡子，將裂痕映射在臉上，讓每一個不完美的角落變得無比尖銳，時不時扎進心房。</p>
        </div>
    </div>

    <div class="empty-section"></div>

    <!-- 第四章 -->
     <div class="chapter-section" id="chapter4">
        <div class="chapter-title">【第三章】</div> <!-- Sticky 標題 -->
        <div class="content">
            <h2>小標</h2>
            <p>在自我展示成為常態的時代，我們或許都曾在某一刻，定格在那片冷冽的反光中，端詳自己的面孔，試圖尋找些什麼，也許是美，也許是缺陷。然而，我們真正尋找的，是滿足社會期待的完美形象，還是某種讓自己安心的確認：「我看起來還不錯吧？」</p>
            <p>但在那追尋的過程中，有些人開始迷失在鏡像、影像與現實之間，容貌焦慮便從這樣的縫隙中悄然滋生。它不是簡單的對外貌的關注，而是像黑霧般的焦慮，逐漸吞噬對自我的認同感。</p>
            
            <p><strong style="color: green;">容貌焦慮，是當我們無法從鏡子裡看見真實的自己，而只能看到他人與自我期待的樣貌時，心底所泛起的恐懼。</strong></p>
            
            <p>猶如一面破碎的鏡子，將裂痕映射在臉上，讓每一個不完美的角落變得無比尖銳，時不時扎進心房。</p>
        </div>
    </div>

    <div class="empty-section"></div>

    <!-- 第五章 -->
    <div class="chapter-section" id="chapter5">
        <div class="chapter-title">【第三章】</div> <!-- Sticky 標題 -->
        <div class="content">
            <h2>小標</h2>
            <p>在自我展示成為常態的時代，我們或許都曾在某一刻，定格在那片冷冽的反光中，端詳自己的面孔，試圖尋找些什麼，也許是美，也許是缺陷。然而，我們真正尋找的，是滿足社會期待的完美形象，還是某種讓自己安心的確認：「我看起來還不錯吧？」</p>
            <p>但在那追尋的過程中，有些人開始迷失在鏡像、影像與現實之間，容貌焦慮便從這樣的縫隙中悄然滋生。它不是簡單的對外貌的關注，而是像黑霧般的焦慮，逐漸吞噬對自我的認同感。</p>
            
            <p><strong style="color: green;">容貌焦慮，是當我們無法從鏡子裡看見真實的自己，而只能看到他人與自我期待的樣貌時，心底所泛起的恐懼。</strong></p>
            
            <p>猶如一面破碎的鏡子，將裂痕映射在臉上，讓每一個不完美的角落變得無比尖銳，時不時扎進心房。</p>
        </div>
    </div>

    <script>
        document.addEventListener('scroll', handleScroll);

        function handleScroll() {
            const hero = document.querySelector('.hero');
            const chapter1Section = document.querySelector('#chapter1');
            const chapter1Title = chapter1Section.querySelector('.chapter-title');
            const contentSection = chapter1Section.querySelector('.content-section');
            const heroHeight = hero.offsetHeight;
            const scrollPosition = window.scrollY;

            // 当滚动超过视窗 1% 时，将 chapter1 标题固定在顶部，并且 hero 区域平滑上移离开视窗
            if (scrollPosition >= window.innerHeight * 0.01) {
                if (!chapter1Title.classList.contains('fixed')) {
                    chapter1Title.classList.add('fixed');
                    hero.classList.add('hidden');
                }
            } else {
                if (chapter1Title.classList.contains('fixed')) {
                    chapter1Title.classList.remove('fixed');
                    hero.classList.remove('hidden');
                }
            }

            // 当 content-section 的下缘滚动到视窗顶部时，移除 fixed 类
            const contentBottom = contentSection.getBoundingClientRect().bottom + window.scrollY;
            if (scrollPosition >= contentBottom - window.innerHeight) {
                chapter1Title.classList.remove('fixed');
            }

            // 处理图片切换逻辑
            const triggerSection = document.getElementById('trigger-section');
            const images = document.querySelectorAll('.image-switch');
            const sectionTop = triggerSection.getBoundingClientRect().top + window.scrollY;
            const sectionHeight = triggerSection.offsetHeight;

            // 定义每张图片显示的滚动触发点
            const triggerPoints = [
                sectionTop,                             // 第一张图片显示的开始
                sectionTop + sectionHeight / 4,         // 第二张图片显示的开始
                sectionTop + (sectionHeight / 4) * 2,   // 第三张图片显示的开始
                sectionTop + (sectionHeight / 4) * 3    // 第四张图片显示的开始
            ];

            images.forEach((img, index) => {
                if (scrollPosition >= triggerPoints[index] && (index === images.length - 1 || scrollPosition < triggerPoints[index + 1])) {
                    img.style.display = 'block';
                    img.classList.remove('hidden');
                } else {
                    img.style.display = 'none';
                }
            });

            // 处理最后一张图片的淡出效果
            const lastImage = images[images.length - 1];
            const fadeOutTrigger = triggerPoints[triggerPoints.length - 1] + sectionHeight / 4;

            if (scrollPosition >= fadeOutTrigger) {
                lastImage.classList.add('hidden');
            } else {
                lastImage.classList.remove('hidden');
            }

            // 當滾動超過 hero 區域的高度時，顯示 chapter1
            if (scrollPosition >= hero.offsetHeight) {
                chapter1Section.style.display = 'block'; // 顯示 chapter1
            } else {
                chapter1Section.style.display = 'none'; // 隱藏 chapter1
            }
        }
    </script>
    
    <script>
        document.addEventListener('scroll', function () {
            const titles = document.querySelectorAll('.chapter-title');
            const contents = document.querySelectorAll('.content');
            const windowHeight = window.innerHeight;

            titles.forEach((title, index) => {
                const currentContent = contents[index];
                const nextContent = contents[index + 1];
                const contentRect = currentContent.getBoundingClientRect();
                const nextContentRect = nextContent ? nextContent.getBoundingClientRect() : null;

                

                // 當下一章節進視窗，當前標題隱藏
                if (nextContentRect && nextContentRect.top < windowHeight * 0.8) {
                    title.classList.add('hide'); // 當滾動到下一章節時，隱藏當前標題
                    const nextTitle = titles[index + 1];
                    nextTitle.classList.add('sticky');
                    nextContent.classList.add('sticky');
                } else if (nextContentRect && nextContentRect.top >= windowHeight * 0.8) {
                    title.classList.remove('hide'); // 當滾回前面章節時，移除隱藏，顯示標題
                }
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            console.log('DOM 加載完成，開始初始化導航點');
            const dotNav = document.querySelector('.dot-nav');
            
            if (dotNav) {
                console.log('找到導航點元素:', dotNav);
            } else {
                console.error('未找到導航點元素');
            }
           
            const heroHeight = document.querySelector('.hero').offsetHeight;
            const content = document.querySelector('.content');
       
            // 背景顏色變化根據滾動位置
            window.addEventListener('scroll', function() {
                const scrollPosition = window.scrollY;
                const scrollRatio = Math.min(scrollPosition / heroHeight, 1);
                
                // 計算新的背景顏色
                const startColor = [140, 128, 105]; // #8C8069
                const endColor = [243, 230, 204]; // #F3E6CC
                const newColor = startColor.map((start, index) => {
                    const end = endColor[index];
                    return Math.round(start + (end - start) * scrollRatio);
                });
                document.body.style.backgroundColor = `rgb(${newColor.join(',')})`;
            });
    
            // 圖表相關代碼
            var ctx = document.getElementById('myChart').getContext('2d');
            var finalData = [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60]; // 最終數據
            var maxValue = Math.max(...finalData);
    
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['2021年3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月', '2022年1月', '2月'],
                    datasets: [{
                        label: '臉書及「容貌焦慮」的貼文數',
                        data: Array(finalData.length).fill(0), // 初始化為全 0
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: maxValue // 設置 y 軸的最大值
                        }
                    },
                    animation: false // 禁用 Chart.js 的內建動畫
                }
            });
    
            // 創建 ScrollMagic 控制器
            var controller = new ScrollMagic.Controller();
    
            // 動畫狀態
            var isAnimating = false;
    
            // 創建場景
            var scene = new ScrollMagic.Scene({
                triggerElement: "#chart-container",
                triggerHook: 0.8, // 當元素的 80% 進入視窗時觸發
                reverse: true // 允許重複觸發
            })
            .on('enter', function () {
                if (!isAnimating) {
                    animateChart();
                }
            })
            .on('leave', function () {
                // 當離開觸發區域時，重置圖表數據為 0
                myChart.data.datasets[0].data = Array(finalData.length).fill(0);
                myChart.update();
                isAnimating = false;
            })
            .addTo(controller);
    
            function animateChart() {
                isAnimating = true;
                var animationDuration = 2000; // 動畫持續時間（毫秒）
                var frameDuration = 1000 / 60; // 假設 60fps
                var totalFrames = Math.round(animationDuration / frameDuration);
                var easeOutQuart = function(t) { return 1 - (--t) * t * t * t; }; // 緩動函數
                var frame = 0;
    
                var animateFrame = function() {
                    var progress = easeOutQuart(frame / totalFrames);
                    var currentData = finalData.map(value => Math.round(value * progress));
                    myChart.data.datasets[0].data = currentData;
                    myChart.update();
    
                    if (frame < totalFrames) {
                        frame++;
                        requestAnimationFrame(animateFrame);
                    } else {
                        isAnimating = false;
                    }
                };
    
                requestAnimationFrame(animateFrame);
            }
    
            // 確保圖片正確加載
            function checkImage(url) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () => resolve(`圖片加載成功: ${url}`);
                    img.onerror = () => reject(`圖片加載失敗: ${url}`);
                    img.src = url;
                });
            }
    
            checkImage('images/mirror_piece.png')
                .then(message => console.log(message))
                .catch(error => console.error(error));
    
            const dots = document.querySelectorAll('.dot-nav .dot');
            const sections = document.querySelectorAll('.section');
    
            // 點擊圓點時滾動到對應區域
            dots.forEach(dot => {
                dot.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('data-section');
                    const targetSection = document.getElementById(targetId);
                    targetSection.scrollIntoView({ behavior: 'smooth' });
                });
            });
    
            // 滾動時更新活動圓點
            window.addEventListener('scroll', function() {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (pageYOffset >= sectionTop - sectionHeight / 3) {
                        current = section.getAttribute('id');
                    }
                });
    
                dots.forEach(dot => {
                    dot.classList.remove('active');
                    if (dot.getAttribute('data-section') === current) {
                        dot.classList.add('active');
                    }
                });
            });
    
            function nextQuestion(currentQuestion) {
                const currentElement = document.getElementById(`question-${currentQuestion}`);
                const nextElement = document.getElementById(`question-${currentQuestion + 1}`);
                currentElement.style.display = 'none';
                if (nextElement) {
                    nextElement.style.display = 'block';
                }
            }
    
            function calculateScore() {
                const form = document.getElementById('quiz-form');
                const formData = new FormData(form);
                let score = 0;
    
                for (let entry of formData.entries()) {
                    score += parseInt(entry[1]);
                }
    
                const resultDiv = document.getElementById('result');
                let resultText = '';
    
                if (score < 15) {
                    resultText = '恭喜你沒有容貌焦慮的問題！';
                } else if (score >= 15 && score <= 20) {
                    resultText = '你對容貌已經有焦慮的傾向，可能已影響生活，可透過專業協助恢復生活品質。';
                } else {
                    resultText = '你極有可能有容貌焦慮的問題，且對生活造成不少影響，建尋求醫療資協助。';
                }

                resultDiv.textContent = `你的總得分是 ${score} 分。${resultText}`;
            }

            // 監聽導航點的活動狀態更新
            window.nextQuestion = nextQuestion;
            window.calculateScore = calculateScore;

        });

    </script>
   
</body>
</html>